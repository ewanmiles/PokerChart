<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<ion-content>
  <div #head>
    <h1 class="head">Poker Chart</h1>
    <h2>Add your take after each hand and track your game!</h2>
  </div>

  <div #buyScreen class="add-buy">
    <h2 class="buy">Enter your buy-in for the game:</h2>

    <p class="pound-sign">£</p>
    <ion-input class="buy" #buy></ion-input>

    <div class="flex error" #buyError>
      <ion-icon name="alert-circle-outline"></ion-icon>
      <p>Please enter a number for your buy-in!</p>
    </div>

    <div class="start">
      <ion-button (click)="startGame()">Start</ion-button>
    </div>
  </div>

  <div #buttons class="flex buttons">
    <ion-button #loss class="loss" (click)="showInput('loss')">Loss</ion-button>
    <ion-button #gain class="gain" (click)="showInput('gain')">Gain</ion-button>
  </div>

  <div id="hidden">
    <ion-input
    #take
    class="change"
    inputmode="decimal"
    name="change">
    </ion-input>
  
    <div class="submit">
      <ion-button #submit (click)="submitChange()">Submit {{ this.changeType }}</ion-button>
    </div>
  
    <div class="flex error" #changeError>
      <ion-icon name="alert-circle-outline"></ion-icon>
      <p>Not a valid {{ this.changeType }}, please enter a number</p>
    </div>
  </div>

  <div #slide class="slide-down">
    <h2>Current stack size</h2>
    <h2>£{{ this.stackSize }}</h2>

    <div class="flex percent" 
    [style.color]="this.percChange > 0 ? 'var(--ion-color-success)' :
                      this.percChange < 0 ? 'var(--ion-color-danger)' :
                      'var(--ion-color-light-contrast)'">

      <ion-icon name="caret-up-outline" *ngIf="this.percChange > 0"></ion-icon>
      <ion-icon name="caret-down-outline" *ngIf="this.percChange < 0"></ion-icon>
      <ion-icon name="remove-outline" *ngIf="this.percChange === 0"></ion-icon>

      <h3>({{ this.percChange.toFixed(1) }}%)</h3>
    </div>

    <div class="graph">
      <h3 class="subtitle">Stack Size vs. Hand Number</h3>
      <canvas #stackChart></canvas>

      <h4>Peak stack size: £{{ this.peakStack.toFixed(2) }}</h4>
    </div>

    <div class="graph">
      <h3 class="subtitle">Stack Change (increase/decrease) vs. Hand Number</h3>
      <canvas #changeChart></canvas>

      <h4>Average change per hand: £{{ this.avgChange.toFixed(2) }}</h4>
    </div>

    <div class="graph">
      <h3 class="subtitle" *ngIf="this.takeNumber === 0">Top Takes</h3>
      <h3 class="subtitle" *ngIf="this.takeNumber === 1">Top Take</h3>
      <h3 class="subtitle" *ngIf="this.takeNumber > 1">Top {{ this.takeNumber }} Takes</h3>
      <canvas #takeChart></canvas>

      <h4 *ngIf="this.takeArray.length > 0" >Best win: £{{ this.takeArray[0].toFixed(2) }}</h4>
    </div>

  </div>

</ion-content>
